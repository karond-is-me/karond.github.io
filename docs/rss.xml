<?xml version='1.0' encoding='UTF-8'?>
<rss xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/" version="2.0"><channel><title>karond</title><link>https://karond-is-me.github.io/karond.github.io</link><description>æ‹’ç»èŠ±é‡Œèƒ¡å“¨</description><copyright>karond</copyright><docs>http://www.rssboard.org/rss-specification</docs><generator>python-feedgen</generator><image><url>https://github.githubassets.com/favicons/favicon.svg</url><title>avatar</title><link>https://karond-is-me.github.io/karond.github.io</link></image><lastBuildDate>Wed, 17 Apr 2024 13:50:37 +0000</lastBuildDate><managingEditor>karond</managingEditor><ttl>60</ttl><webMaster>karond</webMaster><item><title>Rustï¼šè®©Pythonå†æ¬¡ä¼Ÿå¤§ï¼ä½¿ç”¨PyO3åˆ›å»ºPythonæ¨¡å—</title><link>https://karond-is-me.github.io/karond.github.io/post/Rust%EF%BC%9A-rang-Python-zai-ci-wei-da-%EF%BC%81-shi-yong-PyO3-chuang-jian-Python-mo-kuai.html</link><description>æœ¬ç¯‡ä¸­ä½ å°†çœ‹åˆ°ï¼š&#13;
- ä»é›¶ä½¿ç”¨PyO3åˆ›å»ºä¸€ä¸ªPythonæ¨¡å—&#13;
&#13;
&#13;
# Round1 ä½¿ç”¨PyO3åˆ›å»ºç¬¬ä¸€ä¸ªRustè¯­è¨€çš„Pythonæ¨¡å—&#13;
## å‡†å¤‡å·¥ä½œ&#13;
é¦–å…ˆè¦å®‰è£…Pythonå’ŒRustï¼ŒPyO3å®˜æ–¹çš„ç‰ˆæœ¬è¦æ±‚æ˜¯ï¼š&#13;
- Python 3.7 and up (CPython, PyPy, and GraalPy)&#13;
- Rust 1.56 and up&#13;
&#13;
æˆ‘åœ¨æœ¬æœºå®‰è£…çš„åŸºæœ¬æ˜¯æœ€æ–°ç‰ˆæœ¬&#13;
```bash&#13;
(base) karond:~/code/rust/mypym$ python --version&#13;
Python 3.12.1&#13;
(base) karond:~/code/rust/mypym$ pip --version&#13;
pip 23.3.1 from /home/karond/.miniconda3/lib/python3.12/site-packages/pip (python 3.12)&#13;
(base) karond:~/code/rust/mypym$ rustc --version&#13;
rustc 1.77.2 (25ef9e3d8 2024-04-09)&#13;
(base) karond:~/code/rust/mypym$ cargo --version&#13;
cargo 1.77.2 (e52e36006 2024-03-26)&#13;
```&#13;
## åˆ›å»ºä¸€ä¸ªé¡¹ç›®&#13;
å…ˆä¸è¦æ€¥äºä½¿ç”¨cargoåˆ›å»ºä¸€ä¸ªé¡¹ç›®ï¼Œæˆ‘ä»¬åˆ›å»ºçš„é¡¹ç›®æœ€ç»ˆæ˜¯è¦ç”Ÿæˆä¸€ä¸ªå¯ä»¥ä½¿ç”¨pipå®‰è£…çš„Pythonæ¨¡å—ï¼Œè€Œç”Ÿæˆæ¨¡å—å¯ä»¥ä½¿ç”¨setuptoolså’Œmaturinï¼Œå®˜æ–¹æ¨èmaturinå› æ­¤æˆ‘ä»¬ä½¿ç”¨pipå®‰è£…maturinå¹¶åˆ›å»ºé¡¹ç›®ï¼Œéœ€è¦é€‰æ‹©pyo3é¡¹ç›®&#13;
```bash&#13;
(base) karond:~/code/rust/mypym$ pip install maturin&#13;
Looking in indexes: https://pypi.tuna.tsinghua.edu.cn/simple&#13;
Collecting maturin&#13;
  Downloading https://pypi.tuna.tsinghua.edu.cn/packages/d2/e0/886abd982f4dc1031cc947909e75e9bbbb4c2d76f5ffd23a7236784135af/maturin-1.5.1-py3-none-manylinux_2_12_x86_64.manylinux2010_x86_64.musllinux_1_1_x86_64.whl (10.3 MB)&#13;
     â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â” 10.3/10.3 MB 2.7 MB/s eta 0:00:00&#13;
Installing collected packages: maturin&#13;
Successfully installed maturin-1.5.1&#13;
(base) karond:~/code/rust/mypym$ maturin init&#13;
? ğŸ¤· Which kind of bindings to use?&#13;
  ğŸ“– Documentation: https://maturin.rs/bindings.html â€º&#13;
â¯ pyo3&#13;
  rust-cpython&#13;
  cffi&#13;
  uniffi&#13;
  bin&#13;
```&#13;
å¯ä»¥çœ‹åˆ°ç”Ÿæˆçš„é¡¹ç›®é‡Œæœ‰ä¸€æ®µå®ä¾‹ä»£ç ï¼Œä½œç”¨å°±æ˜¯åˆ›å»ºä¸€ä¸ªæ¨¡å—æ¨¡å—ä¸‹é¢å­˜åœ¨ä¸€ä¸ªå‡½æ•°ï¼Œæ˜¯è®©ä¸¤ä¸ªæ•°ç›¸åŠ å¹¶è¿”å›ç»“æœçš„å­—ç¬¦ä¸²&#13;
```rust&#13;
use pyo3::prelude::*;&#13;
&#13;
/// Formats the sum of two numbers as string.&#13;
#[pyfunction]&#13;
fn sum_as_string(a: usize, b: usize) -&gt; PyResult&lt;String&gt; {&#13;
    Ok((a + b).to_string())&#13;
}&#13;
&#13;
/// A Python module implemented in Rust.&#13;
#[pymodule]&#13;
fn mypym(_py: Python, m: &amp;PyModule) -&gt; PyResult&lt;()&gt; {&#13;
    m.add_function(wrap_pyfunction!(sum_as_string, m)?)?;&#13;
    Ok(())&#13;
}&#13;
```&#13;
## æ„å»ºæ¨¡å—&#13;
ä½¿ç”¨`maturin build --release`å‘½ä»¤æ„å»ºæ¨¡å—ï¼Œç»è¿‡æ¼«é•¿çš„è¾“å‡ºä»¥åæœ€ç»ˆçš„è¾“å‡ºæŒ‡å‡ºæ„å»ºå¥½çš„æ¨¡å—ä¿å­˜åœ¨target/wheelsæ–‡ä»¶å¤¹ä¸‹ï¼Œæ¨¡å—å¤§å°ä»…æœ‰225KB&#13;
```bash&#13;
karond:~/code/rust/mypym$ maturin build --release&#13;
  Downloaded bitflags v1.3.2 (registry `rsproxy-sparse`)&#13;
  Downloaded redox_syscall v0.4.1 (registry `rsproxy-sparse`)&#13;
...&#13;
   Compiling mypym v0.1.0 (/home/karond/code/rust/mypym)&#13;
    Finished release [optimized] target(s) in 23.61s&#13;
ğŸ“¦ Built wheel for CPython 3.12 to /home/karond/code/rust/mypym/target/wheels/mypym-0.1.0-cp312-cp312-manylinux_2_34_x86_64.whl&#13;
&#13;
karond:~/code/rust/mypym$ ls -lh /home/karond/code/rust/mypym/target/wheels/mypym-0.1.0-cp312-cp312-manylinux_2_34_x86_64.whl&#13;
-rw-r--r-- 1 karond karond 225K Apr 17 21:38 /home/karond/code/rust/mypym/target/wheels/mypym-0.1.0-cp312-cp312-manylinux_2_34_x86_64.whl&#13;
```&#13;
&#13;
æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨pipå®‰è£…è¿™ä¸ªæ¨¡å—è¯•ä¸€è¯•&#13;
```bash&#13;
(base) karond:~/code/rust/mypym$ pip install target/wheels/mypym-0.1.0-cp312-cp312-manylinux_2_34_x86_64.whl&#13;
Looking in indexes: https://pypi.tuna.tsinghua.edu.cn/simple&#13;
Processing ./target/wheels/mypym-0.1.0-cp312-cp312-manylinux_2_34_x86_64.whl&#13;
Installing collected packages: mypym&#13;
Successfully installed mypym-0.1.0&#13;
(base) karond:~/code/rust/mypym$ python&#13;
Python 3.12.1 | packaged by Anaconda, Inc. | (main, Jan 19 2024, 15:51:05) [GCC 11.2.0] on linux&#13;
Type "help", "copyright", "credits" or "license" for more information.&#13;
&gt;&gt;&gt; import mypym&#13;
&gt;&gt;&gt; mypym.&#13;
mypym.mypym           mypym.sum_as_string(&#13;
&gt;&gt;&gt; mypym.sum_as_string(1234,4321)&#13;
'5555'&#13;
```&#13;
## æ€»ç»“&#13;
åˆ›å»ºç¬¬ä¸€Rustè¯­è¨€çš„Pythonæ¨¡å—å°±æ˜¯è¿™ä¹ˆç®€å•ã€‚</description><guid isPermaLink="true">https://karond-is-me.github.io/karond.github.io/post/Rust%EF%BC%9A-rang-Python-zai-ci-wei-da-%EF%BC%81-shi-yong-PyO3-chuang-jian-Python-mo-kuai.html</guid><pubDate>Wed, 17 Apr 2024 13:27:37 +0000</pubDate></item><item><title>è§£å†³rustupå®‰è£…å’Œæ›´æ–°Rustè¿‡æ…¢çš„é—®é¢˜</title><link>https://karond-is-me.github.io/karond.github.io/post/jie-jue-rustup-an-zhuang-he-geng-xin-Rust-guo-man-de-wen-ti.html</link><description>å›½å†…è¿æ¥é»˜è®¤çš„é•œåƒé€Ÿåº¦è¿‡æ…¢ï¼Œå»ºè®®å®‰è£…è¿‡çš„æ²¡å®‰è£…è¿‡çš„éƒ½è®¾ç½®ä¸€æ¬¡ï¼ï¼&#13;
æ­¥éª¤ä¸€ï¼šè®¾ç½® Rustup é•œåƒï¼Œ ä¿®æ”¹é…ç½® ~/.zshrc or ~/.bashrc&#13;
``` bash&#13;
export RUSTUP_DIST_SERVER="https://rsproxy.cn"&#13;
export RUSTUP_UPDATE_ROOT="https://rsproxy.cn/rustup"&#13;
```&#13;
æ­¥éª¤äºŒï¼šå®‰è£… Rust æˆ–æ›´æ–°Rust&#13;
``` bash&#13;
#å®‰è£…&#13;
curl --proto '=https' --tlsv1.2 -sSf https://rsproxy.cn/rustup-init.sh | sh&#13;
#æ›´æ–°&#13;
rustup self update&#13;
rustup update stable&#13;
```&#13;
æ­¥éª¤ä¸‰ï¼šè®¾ç½® crates.io é•œåƒï¼Œ ä¿®æ”¹é…ç½® ~/.cargo/configï¼Œå·²æ”¯æŒgitåè®®å’Œsparseåè®®ï¼Œ&gt;=1.68 ç‰ˆæœ¬å»ºè®®ä½¿ç”¨ sparse-indexï¼Œé€Ÿåº¦æ›´å¿«ã€‚</description><guid isPermaLink="true">https://karond-is-me.github.io/karond.github.io/post/jie-jue-rustup-an-zhuang-he-geng-xin-Rust-guo-man-de-wen-ti.html</guid><pubDate>Thu, 04 Apr 2024 13:35:44 +0000</pubDate></item><item><title>æˆ‘å†æµ‹è¯•ä¸€æ¬¡</title><link>https://karond-is-me.github.io/karond.github.io/post/wo-zai-ce-shi-yi-ci.html</link><description>æµ‹è¯•è¿‡å•Šã€‚</description><guid isPermaLink="true">https://karond-is-me.github.io/karond.github.io/post/wo-zai-ce-shi-yi-ci.html</guid><pubDate>Sun, 31 Mar 2024 12:31:14 +0000</pubDate></item><item><title>æµ‹è¯•å•Š</title><link>https://karond-is-me.github.io/karond.github.io/post/ce-shi-a.html</link><description>æµ‹è¯•ã€‚</description><guid isPermaLink="true">https://karond-is-me.github.io/karond.github.io/post/ce-shi-a.html</guid><pubDate>Sun, 31 Mar 2024 05:34:14 +0000</pubDate></item></channel></rss>